FROM mozmeao/base:python-3.6-alpine

RUN apk add --update --no-cache postgresql-dev

ENV PATH=/usr/lib/node_modules/standup/node_modules/.bin:$PATH
ENV PIPELINE_LESS_BINARY=lessc
ENV PIPELINE_UGLIFYJS_BINARY=uglifyjs
ENV PIPELINE_CLEANCSS_BINARY=cleancss

# Project settings
ENV DJANGO_SETTINGS_MODULE standup.settings

EXPOSE 8000
WORKDIR /app
CMD ["/app/bin/run.sh", "prod"]

COPY requirements.txt ./
RUN pip install --require-hashes --no-cache-dir -r requirements.txt
